{"version":3,"file":"index.js","sources":["webpack:///webpack/bootstrap ca4c0b5833755fbe3a61","webpack:///./src/index.coffee","webpack:///./src/soundwave.coffee","webpack:///./src/polyfill.coffee","webpack:///./src/functions.coffee","webpack:///./src/_util.coffee"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ca4c0b5833755fbe3a61\n **/","require './polyfill'\nwindow.Soundwave = require './soundwave'\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.coffee\n **/","{ Func, Ease } = require './functions'\n_ = require './_util'\n\nclass Soundwave\n  EaseFunc = 'Sine3InOut'\n  # how many pixels per points\n  constructor: (@canvas) ->\n    @tick = 0\n    @analyserNode = null\n    @funcs = []\n    @ctx = @canvas.getContext '2d'\n    if window? then window.addEventListener 'resize', @onResize\n    @onResize()\n\n  addWave: (obj) =>\n    throw TypeError \"no such type: #{obj?.type}\" unless Func[obj?.type]?\n    unless Number.isFinite obj.speed\n      throw TypeError \"speed should be a number but got #{obj.speed}\"\n    unless Number.isFinite obj.waveLength\n      throw TypeError \"waveLength should be a number but got #{obj.waveLength}\"\n    unless Number.isFinite obj.amplitude\n      throw TypeError \"amplitude should be a number but got #{obj.amplitude}\"\n    unless Number.isFinite obj.shift\n      throw TypeError \"shift should be a number but got #{obj.shift}\"\n    @funcs.push Func[obj.type](obj.speed, obj.waveLength, obj.amplitude, obj.shift)\n\n  calc: =>\n    ++@tick\n    window.requestAnimationFrame @paint\n\n  connect: (analyserNode) =>\n    @analyserNode = analyserNode\n    @analyserDataArray = new Uint8Array(1 << 10)\n\n  paint: =>\n    if @analyserNode?\n      @analyserNode.getByteFrequencyData @analyserDataArray\n      easing = Ease.fromFrequencyArray @canvas.width, @analyserDataArray\n    else\n      easing = @ease\n    @ctx.clearRect 0, 0, @canvas.width, @canvas.height\n    @funcs.forEach (func, i) =>\n      @ctx.beginPath()\n      j = 0\n      @ctx.moveTo j, @projector easing(j, func(j, @tick))\n      while ++j < @canvas.width\n        @ctx.lineTo j, @projector easing(j, func(j, @tick))\n      @ctx.stroke()\n    nextTick @calc\n\n  start: => @calc()\n\n  onResize: =>\n    rect = @canvas.getBoundingClientRect()\n    @canvas.width = rect.width\n    @canvas.height = rect.height\n    @ctx.lineWidth = 1\n    @ctx.strokeStyle = 'rgba(0, 0, 0, .4)'\n    @projector = _.createProjectToCanvas @canvas.height\n    @ease = Ease[EaseFunc] @canvas.width\n\nmodule.exports = Soundwave\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/soundwave.coffee\n **/","window.nextTick = do ->\n  if window?.setImmediate\n    return window.setImmediate\n  else if window?.postMessage? && window?.addEventListener?\n    queue = []\n    handler = (ev) ->\n      source = ev.source\n      if (source is window || source is null) && ev.data is 'next tick'\n        ev.stopPropagation()\n        if queue.length > 0\n          fn = queue.shift()\n          fn()\n    window.addEventListener 'message', handler, true\n    return (fn) ->\n      queue.push fn\n      window.postMessage 'next tick', '*'\n  else return (f) -> setTimeout(fn, 0)\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/polyfill.coffee\n **/","HalfPi = Math.PI / 2\nPI2 = Math.PI * 2\n\n# wave animation functions\nsine = (speed, waveLength, amp, shift) ->\n  values = [0...waveLength].map (e) ->\n    amp * Math.sin(e * PI2 / waveLength + shift)\n\n  (x, tick) ->\n    idx = (x - tick * speed) % waveLength\n    idx = (idx + waveLength) % waveLength\n    values[idx]\n\nsquare = (speed, waveLength, amp, shift) ->\n  values = [0...waveLength].map (e) ->\n    amp * (Math.floor((e / waveLength) * 2) * 2 - 1)\n\n  (x, tick) ->\n    idx = (x - tick * speed) % waveLength\n    idx = (idx + waveLength) % waveLength\n    values[idx]\n\ntriangle = (speed, waveLength, amp, shift) ->\n  values = [0...waveLength].map (e) ->\n    x = e / waveLength\n    if x < 0.5\n      amp * (-1 + x * 4)\n    else\n      amp * (3 - x * 4)\n\n  (x, tick) ->\n    idx = (x - tick * speed) % waveLength\n    idx = (idx + waveLength) % waveLength\n    values[idx]\n\neaseSine3InOut = (width) ->\n  value = [0..width].map (e) ->\n    sinX = Math.sin((e / width) * Math.PI)\n    Math.pow(sinX, 3)\n\n  (x, y) ->\n    y * value[x]\n\nfromFrequencyArray = (width, arr) ->\n  (x, y) ->\n    y * arr[~~(x * arr.length / width)] / 256\n\nmodule.exports =\n  Func:\n    sine: sine\n    square: square\n    triangle: triangle\n\n  Ease:\n    Sine3InOut: easeSine3InOut\n    fromFrequencyArray: fromFrequencyArray\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/functions.coffee\n **/","class Util\n  # map [-1, 1] -> [0, height]\n  @createProjectToCanvas: (height) ->\n    (input) -> height * .5 * (1 + input)\n\nmodule.exports = Util\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/_util.coffee\n **/"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACtCA;AACA;AAAA;;;;;;;ACDA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AAAA;;;;;;;AACA;AACA;AACA;AACA;AACA;AAAA;;AACA;AANA;AACA;AAOA;AACA;AAAA;;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AAVA;AACA;AAWA;AACA;AACA;AAFA;AACA;AAGA;AACA;AACA;AAFA;AACA;AAGA;AACA;AAAA;AACA;AACA;AAFA;AAIA;;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AAEA;AANA;AAAA;AAOA;AAdA;AACA;AAeA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AACA;;;;;AAQA;;;;;;;;AC7DA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;;AAFA;AAOA;AACA;AACA;AACA;AAFA;AAVA;AAaA;AAAA;AAAA;;AAhBA;;;;;;;ACAA;AACA;AADA;AACA;AAAA;AACA;AAEA;AACA;AAAA;;;;AAAA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AAHA;AAJA;AACA;AAQA;AACA;AAAA;;;;AAAA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AAHA;AAJA;AACA;AAQA;AACA;AAAA;;;;AAAA;AACA;AAAA;AACA;AACA;AADA;AAGA;;AALA;AAOA;AACA;AAAA;AACA;AACA;AAHA;AARA;AACA;AAYA;AACA;AAAA;;;;AAAA;AACA;AAAA;AACA;AAFA;AAIA;AACA;AADA;AALA;AACA;AAOA;AACA;AACA;AADA;AADA;AACA;AAGA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AAPA;;;;;;;;AChDA;AACA;AADA;;;AAEA;AACA;AAAA;AAAA;AADA;AACA;;;;;AAEA;;;;","sourceRoot":""}